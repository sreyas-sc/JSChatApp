{"ast":null,"code":"\n\n// import React, { useState, useEffect, useRef } from 'react';\n// import { useNavigate, useParams } from 'react-router-dom';\n// import { io } from 'socket.io-client';\n// import defaultAvatar from '../assets/user (1).png'; // Adjust path as necessary\n// import { PhoneIcon, VideoCameraIcon, PaperAirplaneIcon } from '@heroicons/react/solid';\n\n// const socket = io('http://localhost:3001'); // Replace with your server URL\n\n// const ChatPage = () => {\n//     const [messages, setMessages] = useState([]);\n//     const [messageText, setMessageText] = useState('');\n//     const [receiverEmail, setReceiverEmail] = useState('');\n//     const [error, setError] = useState('');\n//     const messageEndRef = useRef(null);\n//     const navigate = useNavigate();\n//     const { receiverId } = useParams();\n\n//     const userEmail = localStorage.getItem('userEmail');\n//     const storedtoEmail = localStorage.getItem('touserEmail');\n//     const storedtoName = localStorage.getItem('tousername');\n\n//     useEffect(() => {\n//         if (!receiverId) return;\n\n//         // Socket connection events\n//         socket.on('connect', () => {\n//             console.log('Connected to socket server');\n//         });\n\n//         socket.on('disconnect', () => {\n//             console.log('Disconnected from socket server');\n//         });\n\n//         const fetchReceiverEmail = async () => {\n//             try {\n//                 const response = await fetch(`http://localhost:3001/getUserEmailById/${receiverId}`);\n//                 const result = await response.json();\n//                 if (result.userEmail) {\n//                     setReceiverEmail(result.userEmail);\n//                 } else {\n//                     throw new Error('No email found for receiver');\n//                 }\n//             } catch (error) {\n//                 console.error('Failed to fetch receiver email:', error);\n//                 setError('Failed to fetch receiver email.');\n//             }\n//         };\n\n//         fetchReceiverEmail();\n\n//         socket.emit('joinRoom', receiverId);\n\n//         socket.on('message', (message) => {\n//             console.log('Received message:', message); // Debug message\n//             setMessages((prevMessages) => [...prevMessages, message]);\n//             messageEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n//         });\n\n//         socket.on('messageDeleted', (messageId) => {\n//             setMessages((prevMessages) => prevMessages.filter((msg) => msg.id !== messageId));\n//         });\n\n//         return () => {\n//             socket.off('connect');\n//             socket.off('disconnect');\n//             socket.off('message');\n//             socket.off('messageDeleted');\n//         };\n//     }, [receiverId]);\n\n//     const handleSendMessage = async () => {\n//         if (messageText.trim()) {\n//             try {\n//                 const response = await fetch('http://localhost:3001/sendMessage', {\n//                     method: 'POST',\n//                     headers: {\n//                         'Content-Type': 'application/json',\n//                     },\n//                     body: JSON.stringify({\n//                         senderEmail: userEmail,\n//                         receiverEmail: storedtoEmail,\n//                         text: messageText,\n//                     }),\n//                 });\n//                 const result = await response.json();\n//                 if (response.ok) {\n//                     setMessageText(''); // Clear the input box\n//                 } else {\n//                     console.error('SendMessage Error:', result.message);\n//                 }\n//             } catch (error) {\n//                 console.error('SendMessage Fetch Error:', error);\n//             }\n//         }\n//     };\n\n//     const handleDeleteMessage = async (messageId) => {\n//         try {\n//             await fetch('http://localhost:3001/deleteMessage', {\n//                 method: 'POST',\n//                 headers: {\n//                     'Content-Type': 'application/json',\n//                 },\n//                 body: JSON.stringify({ messageId }),\n//             });\n//         } catch (error) {\n//             console.error('DeleteMessage Error:', error);\n//         }\n//     };\n\n//     const handleBack = () => {\n//         navigate('/home');\n//     };\n\n//     const handleCallUser = () => {\n//         console.log('Calling user:', receiverId);\n//     };\n\n//     return (\n//         <div className=\"min-h-screen flex flex-col bg-gradient-to-r from-slate-300 to-slate-500 p-4\">\n//             <div className=\"flex items-center mb-4\">\n//                 <img\n//                     src={defaultAvatar}\n//                     alt=\"Avatar\"\n//                     className=\"w-12 h-12 rounded-full mr-4 border-2 border-gray-300\"\n//                 />\n//                 <h1 className=\"text-2xl font-bold\">{storedtoName || 'Loading...'}</h1>\n//             </div>\n\n//             <button\n//                 onClick={handleBack}\n//                 type=\"button\"\n//                 className=\"bg-white text-center w-48 rounded-2xl h-14 relative font-sans text-black text-xl font-semibold group justify-end mt-(-4)\"\n//             >\n//                 <div\n//                     className=\"bg-green-400 rounded-xl h-12 w-1/4 flex items-center justify-center absolute left-1 top-[4px] group-hover:w-[184px] z-10 duration-500\"\n//                 >\n//                     <svg\n//                         width=\"25px\"\n//                         height=\"25px\"\n//                         viewBox=\"0 0 1024 1024\"\n//                         xmlns=\"http://www.w3.org/2000/svg\"\n//                     >\n//                         <path\n//                             fill=\"#000000\"\n//                             d=\"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64z\"\n//                         ></path>\n//                         <path\n//                             fill=\"#000000\"\n//                             d=\"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312L237.248 512z\"\n//                         ></path>\n//                     </svg>\n//                 </div>\n//                 <p className=\"translate-x-2\">Go Back</p>\n//             </button>\n\n//             <div className=\"flex justify-end mb-4\">\n//                 <button\n//                     onClick={handleCallUser}\n//                     className=\"bg-green-500 text-white py-2 px-4 rounded mr-2\"\n//                 >\n//                     <PhoneIcon className=\"w-6 h-6\" />\n//                 </button>\n//                 <button\n//                     onClick={handleCallUser}\n//                     className=\"bg-blue-500 text-white py-2 px-4 rounded\"\n//                 >\n//                     <VideoCameraIcon className=\"w-6 h-6\" />\n//                 </button>\n//             </div>\n\n//             <div className=\"flex flex-col flex-grow overflow-y-auto mb-4\">\n//                 <div className=\"flex-grow\">\n//                     {messages.length > 0 ? (\n//                         messages.map((message) => (\n//                             <div\n//                                 key={message.id}\n//                                 className={`p-4 mb-2 rounded shadow ${\n//                                     message.senderEmail === userEmail ? 'bg-blue-200 self-end' : 'bg-white self-start'\n//                                 }`}\n//                             >\n//                                 <p className=\"font-semibold\">{message.senderEmail}</p>\n//                                 <p>{message.text}</p>\n//                                 {message.senderEmail === userEmail && (\n//                                     <button\n//                                         onClick={() => handleDeleteMessage(message.id)}\n//                                         className=\"text-red-500\"\n//                                     >\n//                                         Delete\n//                                     </button>\n//                                 )}\n//                             </div>\n//                         ))\n//                     ) : (\n//                         <p>No messages yet.</p>\n//                     )}\n//                     <div ref={messageEndRef} />\n//                 </div>\n//             </div>\n\n//             <div className=\"flex\">\n//                 <input\n//                     type=\"text\"\n//                     value={messageText}\n//                     onChange={(e) => setMessageText(e.target.value)}\n//                     placeholder=\"Type your message...\"\n//                     className=\"w-full px-3 py-2 border rounded\"\n//                 />\n//                 <button\n//                     onClick={handleSendMessage}\n//                     className=\"flex items-center justify-center px-4 py-2 bg-blue-500 text-white rounded ml-2\"\n//                 >\n//                     <PaperAirplaneIcon className=\"w-6 h-6\" />\n//                 </button>\n//             </div>\n//         </div>\n//     );\n// };\n\n// export default ChatPage;","map":{"version":3,"names":[],"sources":["C:/Users/Sreyas/OneDrive/Desktop/BellaCode/chat-app-frontend/src/components/Chatpage.js"],"sourcesContent":["\r\n\r\n// import React, { useState, useEffect, useRef } from 'react';\r\n// import { useNavigate, useParams } from 'react-router-dom';\r\n// import { io } from 'socket.io-client';\r\n// import defaultAvatar from '../assets/user (1).png'; // Adjust path as necessary\r\n// import { PhoneIcon, VideoCameraIcon, PaperAirplaneIcon } from '@heroicons/react/solid';\r\n\r\n// const socket = io('http://localhost:3001'); // Replace with your server URL\r\n\r\n// const ChatPage = () => {\r\n//     const [messages, setMessages] = useState([]);\r\n//     const [messageText, setMessageText] = useState('');\r\n//     const [receiverEmail, setReceiverEmail] = useState('');\r\n//     const [error, setError] = useState('');\r\n//     const messageEndRef = useRef(null);\r\n//     const navigate = useNavigate();\r\n//     const { receiverId } = useParams();\r\n\r\n//     const userEmail = localStorage.getItem('userEmail');\r\n//     const storedtoEmail = localStorage.getItem('touserEmail');\r\n//     const storedtoName = localStorage.getItem('tousername');\r\n\r\n//     useEffect(() => {\r\n//         if (!receiverId) return;\r\n\r\n//         // Socket connection events\r\n//         socket.on('connect', () => {\r\n//             console.log('Connected to socket server');\r\n//         });\r\n\r\n//         socket.on('disconnect', () => {\r\n//             console.log('Disconnected from socket server');\r\n//         });\r\n\r\n//         const fetchReceiverEmail = async () => {\r\n//             try {\r\n//                 const response = await fetch(`http://localhost:3001/getUserEmailById/${receiverId}`);\r\n//                 const result = await response.json();\r\n//                 if (result.userEmail) {\r\n//                     setReceiverEmail(result.userEmail);\r\n//                 } else {\r\n//                     throw new Error('No email found for receiver');\r\n//                 }\r\n//             } catch (error) {\r\n//                 console.error('Failed to fetch receiver email:', error);\r\n//                 setError('Failed to fetch receiver email.');\r\n//             }\r\n//         };\r\n\r\n//         fetchReceiverEmail();\r\n\r\n//         socket.emit('joinRoom', receiverId);\r\n\r\n//         socket.on('message', (message) => {\r\n//             console.log('Received message:', message); // Debug message\r\n//             setMessages((prevMessages) => [...prevMessages, message]);\r\n//             messageEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n//         });\r\n\r\n//         socket.on('messageDeleted', (messageId) => {\r\n//             setMessages((prevMessages) => prevMessages.filter((msg) => msg.id !== messageId));\r\n//         });\r\n\r\n//         return () => {\r\n//             socket.off('connect');\r\n//             socket.off('disconnect');\r\n//             socket.off('message');\r\n//             socket.off('messageDeleted');\r\n//         };\r\n//     }, [receiverId]);\r\n\r\n//     const handleSendMessage = async () => {\r\n//         if (messageText.trim()) {\r\n//             try {\r\n//                 const response = await fetch('http://localhost:3001/sendMessage', {\r\n//                     method: 'POST',\r\n//                     headers: {\r\n//                         'Content-Type': 'application/json',\r\n//                     },\r\n//                     body: JSON.stringify({\r\n//                         senderEmail: userEmail,\r\n//                         receiverEmail: storedtoEmail,\r\n//                         text: messageText,\r\n//                     }),\r\n//                 });\r\n//                 const result = await response.json();\r\n//                 if (response.ok) {\r\n//                     setMessageText(''); // Clear the input box\r\n//                 } else {\r\n//                     console.error('SendMessage Error:', result.message);\r\n//                 }\r\n//             } catch (error) {\r\n//                 console.error('SendMessage Fetch Error:', error);\r\n//             }\r\n//         }\r\n//     };\r\n\r\n//     const handleDeleteMessage = async (messageId) => {\r\n//         try {\r\n//             await fetch('http://localhost:3001/deleteMessage', {\r\n//                 method: 'POST',\r\n//                 headers: {\r\n//                     'Content-Type': 'application/json',\r\n//                 },\r\n//                 body: JSON.stringify({ messageId }),\r\n//             });\r\n//         } catch (error) {\r\n//             console.error('DeleteMessage Error:', error);\r\n//         }\r\n//     };\r\n\r\n//     const handleBack = () => {\r\n//         navigate('/home');\r\n//     };\r\n\r\n//     const handleCallUser = () => {\r\n//         console.log('Calling user:', receiverId);\r\n//     };\r\n\r\n//     return (\r\n//         <div className=\"min-h-screen flex flex-col bg-gradient-to-r from-slate-300 to-slate-500 p-4\">\r\n//             <div className=\"flex items-center mb-4\">\r\n//                 <img\r\n//                     src={defaultAvatar}\r\n//                     alt=\"Avatar\"\r\n//                     className=\"w-12 h-12 rounded-full mr-4 border-2 border-gray-300\"\r\n//                 />\r\n//                 <h1 className=\"text-2xl font-bold\">{storedtoName || 'Loading...'}</h1>\r\n//             </div>\r\n\r\n//             <button\r\n//                 onClick={handleBack}\r\n//                 type=\"button\"\r\n//                 className=\"bg-white text-center w-48 rounded-2xl h-14 relative font-sans text-black text-xl font-semibold group justify-end mt-(-4)\"\r\n//             >\r\n//                 <div\r\n//                     className=\"bg-green-400 rounded-xl h-12 w-1/4 flex items-center justify-center absolute left-1 top-[4px] group-hover:w-[184px] z-10 duration-500\"\r\n//                 >\r\n//                     <svg\r\n//                         width=\"25px\"\r\n//                         height=\"25px\"\r\n//                         viewBox=\"0 0 1024 1024\"\r\n//                         xmlns=\"http://www.w3.org/2000/svg\"\r\n//                     >\r\n//                         <path\r\n//                             fill=\"#000000\"\r\n//                             d=\"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64z\"\r\n//                         ></path>\r\n//                         <path\r\n//                             fill=\"#000000\"\r\n//                             d=\"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312L237.248 512z\"\r\n//                         ></path>\r\n//                     </svg>\r\n//                 </div>\r\n//                 <p className=\"translate-x-2\">Go Back</p>\r\n//             </button>\r\n\r\n//             <div className=\"flex justify-end mb-4\">\r\n//                 <button\r\n//                     onClick={handleCallUser}\r\n//                     className=\"bg-green-500 text-white py-2 px-4 rounded mr-2\"\r\n//                 >\r\n//                     <PhoneIcon className=\"w-6 h-6\" />\r\n//                 </button>\r\n//                 <button\r\n//                     onClick={handleCallUser}\r\n//                     className=\"bg-blue-500 text-white py-2 px-4 rounded\"\r\n//                 >\r\n//                     <VideoCameraIcon className=\"w-6 h-6\" />\r\n//                 </button>\r\n//             </div>\r\n\r\n//             <div className=\"flex flex-col flex-grow overflow-y-auto mb-4\">\r\n//                 <div className=\"flex-grow\">\r\n//                     {messages.length > 0 ? (\r\n//                         messages.map((message) => (\r\n//                             <div\r\n//                                 key={message.id}\r\n//                                 className={`p-4 mb-2 rounded shadow ${\r\n//                                     message.senderEmail === userEmail ? 'bg-blue-200 self-end' : 'bg-white self-start'\r\n//                                 }`}\r\n//                             >\r\n//                                 <p className=\"font-semibold\">{message.senderEmail}</p>\r\n//                                 <p>{message.text}</p>\r\n//                                 {message.senderEmail === userEmail && (\r\n//                                     <button\r\n//                                         onClick={() => handleDeleteMessage(message.id)}\r\n//                                         className=\"text-red-500\"\r\n//                                     >\r\n//                                         Delete\r\n//                                     </button>\r\n//                                 )}\r\n//                             </div>\r\n//                         ))\r\n//                     ) : (\r\n//                         <p>No messages yet.</p>\r\n//                     )}\r\n//                     <div ref={messageEndRef} />\r\n//                 </div>\r\n//             </div>\r\n\r\n//             <div className=\"flex\">\r\n//                 <input\r\n//                     type=\"text\"\r\n//                     value={messageText}\r\n//                     onChange={(e) => setMessageText(e.target.value)}\r\n//                     placeholder=\"Type your message...\"\r\n//                     className=\"w-full px-3 py-2 border rounded\"\r\n//                 />\r\n//                 <button\r\n//                     onClick={handleSendMessage}\r\n//                     className=\"flex items-center justify-center px-4 py-2 bg-blue-500 text-white rounded ml-2\"\r\n//                 >\r\n//                     <PaperAirplaneIcon className=\"w-6 h-6\" />\r\n//                 </button>\r\n//             </div>\r\n//         </div>\r\n//     );\r\n// };\r\n\r\n// export default ChatPage;\r\n"],"mappings":";;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}