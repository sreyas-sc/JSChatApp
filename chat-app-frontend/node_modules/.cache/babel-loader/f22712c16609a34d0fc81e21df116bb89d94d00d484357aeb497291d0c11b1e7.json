{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Sreyas\\\\OneDrive\\\\Desktop\\\\BellaCode\\\\chat-app-frontend\\\\src\\\\components\\\\AudioCall.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport io from 'socket.io-client';\nimport SimplePeer from 'simple-peer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io('http://localhost:8080'); // WebSocket server URL\n\nconst AudioCall = ({\n  receiverId\n}) => {\n  _s();\n  const [stream, setStream] = useState(null);\n  const [peer, setPeer] = useState(null);\n  const [calling, setCalling] = useState(false);\n  const localAudioRef = useRef(null);\n  const remoteAudioRef = useRef(null);\n  useEffect(() => {\n    // Request user media\n    navigator.mediaDevices.getUserMedia({\n      audio: true\n    }).then(mediaStream => {\n      setStream(mediaStream);\n      if (localAudioRef.current) {\n        localAudioRef.current.srcObject = mediaStream;\n      }\n    });\n    socket.on('offer', handleOffer);\n    socket.on('answer', handleAnswer);\n    socket.on('ice-candidate', handleIceCandidate);\n    return () => {\n      socket.off('offer', handleOffer);\n      socket.off('answer', handleAnswer);\n      socket.off('ice-candidate', handleIceCandidate);\n    };\n  }, []);\n  const startCall = () => {\n    const newPeer = new SimplePeer({\n      initiator: true,\n      trickle: false,\n      stream: stream\n    });\n    newPeer.on('signal', data => {\n      socket.emit('offer', {\n        offer: data,\n        receiverId\n      });\n    });\n    newPeer.on('stream', remoteStream => {\n      remoteAudioRef.current.srcObject = remoteStream;\n    });\n    setPeer(newPeer);\n    setCalling(true);\n  };\n  const handleOffer = data => {\n    const newPeer = new SimplePeer({\n      initiator: false,\n      trickle: false\n    });\n    newPeer.on('signal', signal => {\n      socket.emit('answer', {\n        answer: signal,\n        receiverId\n      });\n    });\n    newPeer.on('stream', remoteStream => {\n      remoteAudioRef.current.srcObject = remoteStream;\n    });\n    newPeer.signal(data.offer);\n    setPeer(newPeer);\n    setCalling(true);\n  };\n  const handleAnswer = data => {\n    peer.signal(data.answer);\n  };\n  const handleIceCandidate = data => {\n    peer.addIceCandidate(new RTCIceCandidate(data.candidate));\n  };\n\n  //   const handleIceCandidate = (data) => {\n  //     if (peer) {\n  //       peer.addIceCandidate(new RTCIceCandidate(data.candidate));\n  //     }\n  //   };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Audio Call\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: localAudioRef,\n      autoPlay: true,\n      muted: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: remoteAudioRef,\n      autoPlay: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: startCall,\n      disabled: calling,\n      children: \"Start Call\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n};\n_s(AudioCall, \"uSjBznZRr9zKDgG1tWkq23aYomo=\");\n_c = AudioCall;\nexport default AudioCall;\nvar _c;\n$RefreshReg$(_c, \"AudioCall\");","map":{"version":3,"names":["React","useState","useRef","useEffect","io","SimplePeer","jsxDEV","_jsxDEV","socket","AudioCall","receiverId","_s","stream","setStream","peer","setPeer","calling","setCalling","localAudioRef","remoteAudioRef","navigator","mediaDevices","getUserMedia","audio","then","mediaStream","current","srcObject","on","handleOffer","handleAnswer","handleIceCandidate","off","startCall","newPeer","initiator","trickle","data","emit","offer","remoteStream","signal","answer","addIceCandidate","RTCIceCandidate","candidate","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","muted","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/Users/Sreyas/OneDrive/Desktop/BellaCode/chat-app-frontend/src/components/AudioCall.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport io from 'socket.io-client';\r\nimport SimplePeer from 'simple-peer';\r\n\r\nconst socket = io('http://localhost:8080'); // WebSocket server URL\r\n\r\nconst AudioCall = ({ receiverId }) => {\r\n  const [stream, setStream] = useState(null);\r\n  const [peer, setPeer] = useState(null);\r\n  const [calling, setCalling] = useState(false);\r\n  const localAudioRef = useRef(null);\r\n  const remoteAudioRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    // Request user media\r\n    navigator.mediaDevices.getUserMedia({ audio: true })\r\n      .then((mediaStream) => {\r\n        setStream(mediaStream);\r\n        if (localAudioRef.current) {\r\n          localAudioRef.current.srcObject = mediaStream;\r\n        }\r\n      });\r\n\r\n    socket.on('offer', handleOffer);\r\n    socket.on('answer', handleAnswer);\r\n    socket.on('ice-candidate', handleIceCandidate);\r\n\r\n    return () => {\r\n      socket.off('offer', handleOffer);\r\n      socket.off('answer', handleAnswer);\r\n      socket.off('ice-candidate', handleIceCandidate);\r\n    };\r\n  }, []);\r\n\r\n  const startCall = () => {\r\n    const newPeer = new SimplePeer({\r\n      initiator: true,\r\n      trickle: false,\r\n      stream: stream,\r\n    });\r\n\r\n    newPeer.on('signal', (data) => {\r\n      socket.emit('offer', { offer: data, receiverId });\r\n    });\r\n\r\n    newPeer.on('stream', (remoteStream) => {\r\n      remoteAudioRef.current.srcObject = remoteStream;\r\n    });\r\n\r\n    setPeer(newPeer);\r\n    setCalling(true);\r\n  };\r\n\r\n  const handleOffer = (data) => {\r\n    const newPeer = new SimplePeer({\r\n      initiator: false,\r\n      trickle: false,\r\n    });\r\n\r\n    newPeer.on('signal', (signal) => {\r\n      socket.emit('answer', { answer: signal, receiverId });\r\n    });\r\n\r\n    newPeer.on('stream', (remoteStream) => {\r\n      remoteAudioRef.current.srcObject = remoteStream;\r\n    });\r\n\r\n    newPeer.signal(data.offer);\r\n    setPeer(newPeer);\r\n    setCalling(true);\r\n  };\r\n\r\n  const handleAnswer = (data) => {\r\n    peer.signal(data.answer);\r\n  };\r\n\r\n  const handleIceCandidate = (data) => {\r\n    peer.addIceCandidate(new RTCIceCandidate(data.candidate));\r\n  };\r\n\r\n//   const handleIceCandidate = (data) => {\r\n//     if (peer) {\r\n//       peer.addIceCandidate(new RTCIceCandidate(data.candidate));\r\n//     }\r\n//   };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Audio Call</h2>\r\n      <audio ref={localAudioRef} autoPlay muted />\r\n      <audio ref={remoteAudioRef} autoPlay />\r\n      <button onClick={startCall} disabled={calling}>Start Call</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AudioCall;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}